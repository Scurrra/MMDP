### A Pluto.jl notebook ###
# v0.19.0

using Markdown
using InteractiveUtils

# This Pluto notebook uses @bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of @bind gives bound variables a default value (instead of an error).
macro bind(def, element)
    quote
        local iv = try Base.loaded_modules[Base.PkgId(Base.UUID("6e696c72-6542-2067-7265-42206c756150"), "AbstractPlutoDingetjes")].Bonds.initial_value catch; b -> missing; end
        local el = $(esc(element))
        global $(esc(def)) = Core.applicable(Base.get, el) ? Base.get(el) : iv(el)
        el
    end
end

# ‚ïî‚ïê‚ï° 24859bea-a037-11ec-1529-ede51f9bb656
begin
	import Pkg;
	Pkg.activate();

	using DataFrames;

	using RecipesBase;
	using Plots: plot, plot!, @recipe;
	using CairoMakie: Point, Figure, Axis, streamplot, streamplot!, (..)
	
	using DifferentialEquations: SecondOrderODEProblem, ODEProblem, solve;
	using SymPy: @syms, Differential, solve, diff, dsolve

	using LinearAlgebra
	
	abstract type Pendulum end;
	
	using PlutoUI;
	TableOfContents()
end

# ‚ïî‚ïê‚ï° 45d13863-edb9-4eb1-879d-8d4221deca50
md"""
# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ2
# –õ–∏–Ω–µ–π–Ω—ã–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏ –∫–æ–ª–µ–±–∞—Ç–µ–ª—å–Ω—ã—Ö —è–≤–ª–µ–Ω–∏–π
–ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª: –ë–æ—Ä–æ–≤—Å–∫–∏–π –ò–ª—å—è
"""

# ‚ïî‚ïê‚ï° b0cfb272-ebe8-444a-b9e2-7ed8d3979003
md"""
## –ó–∞–¥–∞–Ω–∏–µ 1. –ì–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–µ–±–∞–Ω–∏—è

$\frac{‚ÖÜ^2 r(t)}{‚ÖÜ t^2} + œâ^2 r(t) = 0, r(0) = r‚ÇÄ, \frac{‚ÖÜ r(0)}{‚ÖÜ t} = v‚ÇÄ$

–≥–¥–µ $œâ = \sqrt{k / m} = const > 0$ -- —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ –∫–æ–ª–µ–±–∞–Ω–∏–π.

–†–µ—à–∏–º –¥–∞–Ω–Ω—É—é –º–æ–¥–µ–ª—å. –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–º–µ–µ—Ç –≤–∏–¥:

$Œª^2 + œâ^2 = 0 \Rightarrow Œª = ¬±i‚àöœâ$ -- —Ü–µ–Ω—Ç—Ä.

–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–º–µ–µ—Ç –≤–∏–¥:

$\begin{cases}
	\frac{‚ÖÜ r}{‚ÖÜ t} = v \\
	\frac{‚ÖÜ v}{‚ÖÜ t} = -œâ^2 t
\end{cases}$

### –ó–∞–¥–∞–Ω–∏–µ 1.1 (–ê–º–ø–ª–∏—Ç—É–¥–∞ –∫–æ–ª–µ–±–∞–Ω–∏–π)

–†–µ—à–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º–æ –≤ –≤–∏–¥–µ: $r(t) = A cos(œâ t + œï‚ÇÄ)$

–ü—É—Å—Ç—å $L$ -- —Ä–∞—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Å—Ç–µ–Ω–∫–∏ ‚áí $A ‚â§ L$. –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ —É—Å–ª–æ–≤–∏—è –Ω–∞ –≤–µ–ª–∏—á–∏–Ω—ã –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö $r‚ÇÄ$ –∏ $v‚ÇÄ$.

$\begin{cases}
	r‚ÇÄ = A cos(œï‚ÇÄ) \\
	v‚ÇÄ = -A œâ sin(œï‚ÇÄ)
\end{cases}$
–≥–¥–µ $œï‚ÇÄ ‚â§ arcsin \left( \frac{A}{l} \right)$, $l$ -- –¥–ª–∏–Ω–∞ –Ω–∏—Ç–∏.

–í —Å–ª—É—á–∞–µ $r‚ÇÄ ‚â° 0$ –∏–º–µ–µ–º
$\begin{cases}
	r‚ÇÄ = A \\
	v‚ÇÄ = ¬± A œâ
\end{cases}$
–≥–¥–µ –∑–Ω–∞–∫ $v‚ÇÄ$ –∑–∞–¥–∞—ë—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏.

### –ó–∞–¥–∞–Ω–∏–µ 1.2 (–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å —É—á–µ—Ç–æ–º —Å–æ—É–¥–∞—Ä–µ–Ω–∏—è —Ç–µ–ª–∞ –æ —Å—Ç–µ–Ω–∫—É)
"""

# ‚ïî‚ïê‚ï° 22ef3e0d-c2d7-4806-8d80-793f9ce960b2
md"""
œâ = $(@bind Œ© Slider(0.1:0.1:1, show_value=true, default=1))

r‚ÇÄ = $(@bind R‚ÇÄ Slider(-1:0.1:1, show_value=true, default=0))

v‚ÇÄ = $(@bind V‚ÇÄ Slider(-1:0.1:1, show_value=true, default=0))

L = $(@bind L Slider(0.1:0.1:1, show_value=true, default=1))
"""

# ‚ïî‚ïê‚ï° 7abf4e62-af22-4906-9e23-4f18dd7f67ab
begin
	struct NRPendulum <: Pendulum
		œâ
		
		r‚ÇÄ
		v‚ÇÄ

		L

		solution

		function NRPendulum(œâ::Number, r‚ÇÄ::Number, v‚ÇÄ::Number, L::Number; tspan=(0, 10))

			sol = SecondOrderODEProblem(
				(dr, r, p, t) -> - œâ^2 * r,
				v‚ÇÄ,
				r‚ÇÄ,
				tspan
			) |> solve
			
			new(œâ, r‚ÇÄ, v‚ÇÄ, L,
				sol
			)

		end
	end

	@recipe function f(pendulum::Pendulum)
		ylims := extrema(u -> u[2], pendulum.solution.u) .+ (-0.1-pendulum.L, 0.1)
		
		@series begin
			label := "Pendulum"
			vars := 2
			pendulum.solution
		end
		
		@series begin
			seriestype := :hline
			label := "Wall"
			linewidth := 5
			[-pendulum.L]
		end
	end
end

# ‚ïî‚ïê‚ï° 03ecedd8-5700-4f61-b3e8-72c042c73c11
sol1 = NRPendulum(Œ©, R‚ÇÄ, V‚ÇÄ, L);

# ‚ïî‚ïê‚ï° 5222ff14-5197-4af7-801d-bf652fa8a88a
sol1 |> plot

# ‚ïî‚ïê‚ï° 167ae2e2-0e79-4bb6-a12d-f11f0a5ff0a9
md"""
## –ó–∞–¥–∞–Ω–∏–µ 2. –ö–æ–ª–µ–±–∞–Ω–∏—è —Å —É—á–µ—Ç–æ–º —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è —Å—Ä–µ–¥—ã

$m \frac{‚ÖÜ^2 r(t)}{‚ÖÜ t^2} = -k r(t) - Œº \frac{‚ÖÜ r(t)}{‚ÖÜ t}, r(0) = r‚ÇÄ, \frac{‚ÖÜ r(0)}{‚ÖÜ t} = v‚ÇÄ$

–≥–¥–µ $Œº = const > 0$

–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–º–µ–µ—Ç –≤–∏–¥:

$\begin{cases}
	\frac{‚ÖÜ r}{‚ÖÜ t} = v \\
	\frac{‚ÖÜ v}{‚ÖÜ t} = - \frac{k}{m} r - \frac{Œº}{m} v
\end{cases}$

### –ó–∞–¥–∞–Ω–∏–µ 2.1 (–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ —Ñ–∞–∑–æ–≤–æ–º—É –ø–æ—Ä—Ç—Ä–µ—Ç—É)

–•–∞—Ä–∞–∫—Ç–µ—Ä–µ—Å—Ç–∏—á–µ—Å–∫–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ:

$m Œª^2 + Œº Œª + k = 0$

$Œª = \frac{-Œº ¬± ‚àö(Œº^2 - 4 k m)}{2 m}$

$Re Œª_{1,2} < 0 ‚áí \; –ø–æ–ª–æ–∂–µ–Ω–∏–µ \; —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è r = 0, v = 0 \; –≤—Å–µ–≥–¥–∞ \; —è–≤–ª—è–µ—Ç—Å—è \; —É—Å—Ç–æ–π—á–∏–≤—ã–º$
"""

# ‚ïî‚ïê‚ï° 3755c8f9-466a-4cad-be08-385503dbcd6b
md"""
m = $(@bind M Slider(0:1:10, default=1, show_value=true))

k = $(@bind K Slider(0:0.1:1, default=0.1, show_value=true))
"""

# ‚ïî‚ïê‚ï° aed932a2-e563-475d-84a8-2f6d0d35c32e
md"""
#### 1. $Œº^2 < 4 k m$ (—É—Å—Ç–æ–π—á–∏–≤—ã–π —Ñ–æ–∫—É—Å)

$r(t) = ‚ÑØ^{\frac{- Œº t}{2 m}} \left( A cos \left( \frac{‚àö(4 k m - Œº^2) t}{2 m} \right) + B cos \left( \frac{‚àö(4 k m - Œº^2) t}{2 m} \right) \right)$

**–ó–∞—Ç—É—Ö–∞—é—â–∏–µ –∫–æ–ª–µ–±–∞–Ω–∏—è** —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —É–±—ã–≤–∞—é—â–µ–π –∞–º–ø–ª–∏—Ç—É–¥–æ–π. –ü–µ—Ä–∏–æ–¥ –∫–æ–ª–µ–±–∞–Ω–∏–π –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
"""

# ‚ïî‚ïê‚ï° 6cd36f0b-f2b3-4885-8a4a-16b917e8aa7e
begin
	Œº‚ÇÅ = ‚àö(4 * K * M) - 1
	streamplot(
		(r, v) -> Point(
			v, 
			- K/M * r - Œº‚ÇÅ/M * v
		), -10..10, -10..10
	)
end

# ‚ïî‚ïê‚ï° c46c02cd-5d1a-4f8b-aadd-50e223dde894
md"""
#### 2. $Œº^2 = 4 k m$ (—É—Å—Ç–æ–π—á–∏–≤—ã–π —É–∑–µ–ª)

$r(t) = ‚ÑØ^{\frac{- Œº t}{2 m}} (–°‚ÇÅ + –°‚ÇÇ t)$

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞—Ç—É—Ö–∞–Ω–∏–µ.** –†–µ—à–µ–Ω–∏–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∫–æ–ª–µ–±–ª—é—â–∏–º—Å—è. –û–Ω–æ —è–≤–ª—è–µ—Ç—Å—è —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –∫–æ–ª–µ–±–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∏ –∞–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è. 
"""

# ‚ïî‚ïê‚ï° 8088e6e3-6a90-46d8-9a92-ec143ce55685
begin
	Œº‚ÇÇ = ‚àö(4 * K * M)
	streamplot(
		(r, v) -> Point(
			v, 
			- K/M * r - Œº‚ÇÇ/M * v
		), -10..10, -10..10
	)
end

# ‚ïî‚ïê‚ï° 7b39fe50-fc4a-4b65-b339-d3f6c039c172
md"""
#### 3. $Œº^2 > 4 k m$ (—É—Å—Ç–æ–π—á–∏–≤—ã–π —É–∑–µ–ª, —Ç–∞–∫ –∫–∞–∫ $œâ < Œº$)

$r(t) = ‚ÑØ^{\frac{-Œº t}{2 m}} \left( C‚ÇÅ ‚ÑØ^{\frac{t ‚àö(Œº^2 - 4 k m)}{2 m}} + C‚ÇÇ ‚ÑØ^{\frac{-t ‚àö(Œº^2 - 4 k m)}{2 m}} \right)$

**–ê–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –∑–∞—Ç—É—Ö–∞–Ω–∏–µ.** –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –±–æ–ª—å—à–æ–º—É —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—é —Å—Ä–µ–¥—ã.
"""

# ‚ïî‚ïê‚ï° 86e09784-7678-43ac-885e-6d3eedca7f3e
begin
	Œº‚ÇÉ = ‚àö(4 * K * M) + 1	
	streamplot(
		(r, v) -> Point(
			v, 
			- K/M * r - Œº‚ÇÉ/M * v
		), -10..10, -10..10
	)
end

# ‚ïî‚ïê‚ï° f0eb22f4-b81b-46f3-8157-e99b4c6b5018
md"""
### –ó–∞–¥–∞–Ω–∏–µ 2.2 (–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ —Ç–µ–æ—Ä–µ–º–µ –õ—è–ø—É–Ω–æ–≤–∞)
"""

# ‚ïî‚ïê‚ï° 12fc6293-a695-4c9c-8682-8892dfa081cb
@syms Œª, Œº, k, m

# ‚ïî‚ïê‚ï° c2d02d98-3236-4f44-be6a-78524cc44e6c
A = [0 1; -k/m -Œº/m]

# ‚ïî‚ïê‚ï° 971c1060-6519-4ca2-a873-6c5fccca3caa
solve(det(A - Œª * I) ~ 0, Œª)

# ‚ïî‚ïê‚ï° 54a9c715-1e37-4f02-8b61-1378fa48d54b
md"""
–û–±–∞ –∏–º–µ—é—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—É—é –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—É—é —á–∞—Å—Ç—å, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Ä–µ—à–µ–Ω–∏—è –∞—Å—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–æ–π—á–∏–≤—ã.
"""

# ‚ïî‚ïê‚ï° 168e14d8-933f-445e-a9e6-905611b6e4d7
md"""
### –ó–∞–¥–∞–Ω–∏–µ 2.3 (–ê–Ω–∞–ª–∏–∑ —á–∞—Å—Ç–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤)
"""

# ‚ïî‚ïê‚ï° 529ec0e3-2a4b-422d-949e-ab3a6938ce9c
systype(Œº, k, m) = Œº^2 >= k * m ? "–£—Å—Ç–æ–π—á–∏–≤—ã–π —É–∑–µ–ª" : "–£—Å—Ç–æ–π—á–∏–≤—ã–π —Ñ–æ–∫—É—Å";

# ‚ïî‚ïê‚ï° cea0ab76-7faf-48c3-b6e3-421c76a63082
md"""
–í –≤–æ–∑–¥—É—Ö–µ: $(systype(1.82*10^-5, 10, 10))

–í –≤–æ–¥–µ: $(systype(1.002*10^-3, 10, 10))

–í –≥–ª–∏—Ü–µ—Ä–∏–Ω–µ: $(systype(1.49, 10, 10))
"""

# ‚ïî‚ïê‚ï° 118ae518-5e84-4884-af6b-14cd398aca03
md"""
## –ó–∞–¥–∞–Ω–∏–µ 3. –í—ã–Ω—É–∂–¥–µ–Ω–Ω—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è

$m \frac{‚ÖÜ^2 r(t)}{‚ÖÜ t^2} = -k r(t) + F‚ÇÄ sin(t œâ), r(0) = r‚ÇÄ, \frac{‚ÖÜ r(0)}{‚ÖÜ t} = v‚ÇÄ$

–≥–¥–µ $Œº = const > 0, œâ‚ÇÇ = const > 0$

–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–º–µ–µ—Ç –≤–∏–¥:

$\begin{cases}
	\frac{‚ÖÜ r}{‚ÖÜ t} = v \\
	\frac{‚ÖÜ v}{‚ÖÜ t} = - \frac{k}{m} r + \frac{F‚ÇÄ sin(t œâ)}{m}
\end{cases}$

### –ó–∞–¥–∞–Ω–∏–µ 3.1 (–ß–∞—Å—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ–ª–∏)
#### –†–µ–∑–æ–Ω–∞–Ω—Å–Ω—ã–π —Å–ª—É—á–∞–π

$r‚ÇÅ^*(t) = t (C‚ÇÅ sin(œâ t) + C‚ÇÇ cos(œâ t))$ –≥–¥–µ $œâ = ‚àö\left( \frac{k}{m} \right)$ 

$\dot{r‚ÇÅ^*} = (C‚ÇÅ sin(œâ t) + C‚ÇÇ cos(œâ t)) + œâ t (C‚ÇÅ cos(œâ t) - C‚ÇÇ sin(œâ t)) = (C‚ÇÅ - C‚ÇÇ œâ t) sin(œâ t) + (C‚ÇÅ + C‚ÇÇ œâ t) cos(œâ t)$

$\ddot{r‚ÇÅ^*} = 2 œâ (C‚ÇÅ cos(œâ t) - C‚ÇÇ sin(œâ t)) - œâ^2 t (C‚ÇÅ sin(œâ t) + C‚ÇÇ cos(œâ t)) = (2 œâ C‚ÇÅ - œâ^2 t C‚ÇÇ) cos(œâ t) - (2 œâ C‚ÇÇ + œâ^2 t C‚ÇÅ) sin(œâ t)$

$m ((2 œâ C‚ÇÅ - œâ^2 t C‚ÇÇ) cos(œâ t) - (2 œâ C‚ÇÇ + œâ^2 t C‚ÇÅ) sin(œâ t)) = -k t (C‚ÇÅ sin(œâ t) + C‚ÇÇ cos(œâ t)) + F‚ÇÄ sin(t œâ)$

–ü—Ä–∏ $cos(œâ t)$: $m (2 œâ C‚ÇÅ - œâ^2 t C‚ÇÇ) = -k t C‚ÇÇ ‚áí 2 m œâ C‚ÇÅ - k t C‚ÇÇ = -k t C‚ÇÇ ‚áí 2 m œâ C‚ÇÅ = 0 ‚áí C‚ÇÅ = 0$

–ü—Ä–∏ $sin(œâ t)$: $- m (2 œâ C‚ÇÇ + œâ^2 t C‚ÇÅ) = -k t C‚ÇÅ + F‚ÇÄ ‚áí - 2 m œâ C‚ÇÇ - k t C‚ÇÅ = -k t C‚ÇÅ + F‚ÇÄ ‚áí - 2 m œâ C‚ÇÇ = F‚ÇÄ ‚áí C‚ÇÇ = - \frac{F‚ÇÄ}{2 m œâ}$

$r‚ÇÅ^* = - \frac{F‚ÇÄ t cos(œâ t)}{2 m œâ}$

#### –ë–µ–∑—Ä–µ–∑–æ–Ω–∞–Ω—Å–Ω—ã–π —Å–ª—É—á–∞–π

$r‚ÇÇ^*(t) = C sin(œâ‚ÇÇ t)$ –≥–¥–µ $œâ‚ÇÇ ‚â† œâ$

$- m œâ‚ÇÇ^2 C sin(œâ‚ÇÇ t) = -k C sin(œâ‚ÇÇ t) + F‚ÇÄ sin(œâ‚ÇÇ t)$

$- m œâ‚ÇÇ^2 C = -k C + F‚ÇÄ ‚áí C (k - m œâ‚ÇÇ^2) = F‚ÇÄ$

$C = \frac{F‚ÇÄ}{k - m œâ‚ÇÇ^2} = \frac{F‚ÇÄ}{m(œâ^2 - œâ‚ÇÇ^2}$

$r‚ÇÇ^*(t) = \frac{F‚ÇÄ}{m(œâ^2 - œâ‚ÇÇ^2)} sin(œâ‚ÇÇ t)$
"""

# ‚ïî‚ïê‚ï° db5f5fae-9ee8-4846-8e8a-0185421d1166
md"""
### –ó–∞–¥–∞–Ω–∏–µ 3.2 (–ì—Ä–∞—Ñ–∏–∫–∏ –≤—ã–Ω—É–∂–¥–µ–Ω–Ω—ã—Ö –∫–æ–ª–µ–±–∞–Ω–∏–π)
"""

# ‚ïî‚ïê‚ï° 0bd590eb-9225-4b6b-bbcf-601e0ab074c3
md"""
k = $(@bind kÃá Slider(1:.1:10, show_value=true))

m = $(@bind mÃá Slider(1:.1:10, show_value=true))

F‚ÇÄ = $(@bind F‚ÇÄÃá Slider(1:.1:10, show_value=true))

r‚ÇÄ = $(@bind r‚ÇÄÃá Slider(1:.1:10, show_value=true))

v‚ÇÄ = $(@bind v‚ÇÄÃá Slider(1:.1:10, show_value=true))

œâ‚ÇÇ = $(@bind œâ‚ÇÇÃá Slider(1:.1:10, show_value=true))
"""

# ‚ïî‚ïê‚ï° cf150f5e-c6cd-43b6-9409-12ffd2dc565b
œâ = ‚àö(kÃá / mÃá)

# ‚ïî‚ïê‚ï° 4a208463-d0b5-49ce-9cb6-bc6016eef865
md"""
#### –†–µ–∑–æ–Ω–∞–Ω—Å–Ω—ã–π —Å–ª—É—á–∞–π
"""

# ‚ïî‚ïê‚ï° 7f5bad32-53dc-4ed8-b7ef-f9a76a00b85a
begin
	t = 0:.1:100
	res = r‚ÇÄÃá*cos.(t * œâ) .+ v‚ÇÄÃá*sin.(t * œâ) / œâ .- F‚ÇÄÃá * t .* cos.(t * œâ) / 2 / mÃá / œâ

	plot(
		t, res,
		label=:none
	)
end

# ‚ïî‚ïê‚ï° 1b736870-409e-4efe-b724-5977352378ae
md"""
#### –ù–µ—Ä–µ–∑–æ–Ω–∞–Ω—Å–Ω—ã–π —Å–ª—É—á–∞–π
"""

# ‚ïî‚ïê‚ï° be39fcb8-5592-4a7d-8d29-5dc1f28d22a5
begin
	nres = r‚ÇÄÃá*cos.(t * œâ) .+ v‚ÇÄÃá*sin.(t * œâ) / œâ .+ F‚ÇÄÃá * sin.(t * œâ‚ÇÇÃá) / (kÃá - mÃá * œâ‚ÇÇÃá)

	plot(
		t, nres,
		label=:none
	)
end

# ‚ïî‚ïê‚ï° b5ac39a0-b3f0-4c94-933c-6f707df8989e
md"""
## –ó–∞–¥–∞–Ω–∏–µ 4. –°–∏—Å—Ç–µ–º–∞ –ª–∏–Ω–µ–π–Ω—ã—Ö —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö —Ä–µ–∞–∫—Ü–∏–π

### –ó–∞–¥–∞–Ω–∏–µ 4.1 (–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å)

#### –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏
 - –û–±—ä–µ–∫—Ç–æ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —è–≤–ª—è–µ—Ç—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –≤–µ—â–µ—Å—Ç–≤ X –∏ Y.
 - –í–µ—â–µ—Å—Ç–≤–æ X –ø—Ä–∏—Ç–µ–∫–∞–µ—Ç –∏–∑–≤–Ω–µ —Å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é k‚ÇÅ. –ü—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ X –≤ –≤–µ—â–µ—Å—Ç–≤–æ Y –ø—Ä–æ—Ö–æ–¥–∏—Ç —Å–æ —Å–∫–æ—Ä–æ—Å—Ç—å—é, –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ X —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ k‚ÇÇ. –í–µ—â–µ—Å—Ç–≤–æ Y —Ç–∞–∫–∂–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è –∏–∑ —Å—Ñ–µ—Ä—ã —Ä–µ–∞–∫—Ü–∏–∏ —Å–æ —Å–∫–æ—Ä–æ—Å—Ç—å—é, –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ Y —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ k‚ÇÉ.
 - –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –≤–µ—â–µ—Å—Ç–≤ –≤ –Ω–∞—á–∞–ª—å–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ t = 0: X‚ÇÄ –∏ Y‚ÇÄ.
 - –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –≤–µ—â–µ—Å—Ç–≤ X –∏ Y –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏: X(t) –∏ Y(t).

#### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å
–ù–∞–º –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –≤–µ—â–µ—Å—Ç–≤–æ X –ø—Ä–∏—Ç–µ–∫–∞–µ—Ç –∏–∑–≤–Ω–µ —Å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é k‚ÇÅ.
–°–∫–æ—Ä–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ Y –ø–æ–≤—ã—à–∞–µ—Ç—Å—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ X (—Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º k‚ÇÇ) –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–Ω–∏–∂–∞–µ—Ç—Å—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ Y (—Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º k‚ÇÉ). –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º–æ–∂–µ–º –∑–∞–ø–∏—Å–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —É—Ä–∞–≤–Ω–µ–Ω–∏–π —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

$\begin{cases}
	\frac{‚ÖÜ X(t)}{‚ÖÜ t} = k‚ÇÅ - k‚ÇÇ X \\
	\frac{‚ÖÜ Y(t)}{‚ÖÜ t} = k‚ÇÇ X - k‚ÇÉ Y
\end{cases}$

–£—á—Ç–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è (–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—é –≤–µ—â–µ—Å—Ç–≤–∞ –≤ –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ t = 0):
$\begin{cases}
	X(0) = X‚ÇÄ \\
	Y(0) = Y‚ÇÄ
\end{cases}$

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫—É—é –º–æ–¥–µ–ª—å –∏—Å—Ö–æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏ –º–æ–∂–Ω–æ
–∑–∞–ø–∏—Å–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
$\begin{cases}
	\frac{‚ÖÜ X(t)}{‚ÖÜ t} = k‚ÇÅ - k‚ÇÇ X \\
	\frac{‚ÖÜ Y(t)}{‚ÖÜ t} = k‚ÇÇ X - k‚ÇÉ Y
\end{cases}, \begin{cases}
	X(0) = X‚ÇÄ \\
	Y(0) = Y‚ÇÄ
\end{cases}$
"""

# ‚ïî‚ïê‚ï° 6c18fcfd-9f3e-4ef7-a273-1592a3ca0230
md"""
### –ó–∞–¥–∞–Ω–∏–µ 4.2 (–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏)

k‚ÇÅ = $(@bind k‚ÇÅ Slider(0:.1:10, default=1, show_value=true))

k‚ÇÇ = $(@bind k‚ÇÇ Slider(0:.1:10, default=1, show_value=true))

k‚ÇÉ = $(@bind k‚ÇÉ Slider(0:.1:10, default=1, show_value=true))
"""

# ‚ïî‚ïê‚ï° 7dcf43d8-f9ae-4db1-bb95-e6e12fe305f6
streamplot(
	(x, y) -> Point(
		k‚ÇÅ - k‚ÇÇ*x,
		k‚ÇÇ*x - k‚ÇÉ*y
	), -3..3, -3..3
)

# ‚ïî‚ïê‚ï° 292baf02-5fcf-4978-a5ef-2973f1520998
md"""
## –ó–∞–¥–∞–Ω–∏–µ 5* (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ). –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –ª—é–±–æ–≤–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π

$\begin{cases}
	\frac{ùïï R}{ùïï t} = a \; R + b \; J \\
	\frac{ùïï J}{ùïï t} = c \; R + d \; J
\end{cases}$

–≥–¥–µ $R(t)$ -- —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–ª—é–±–ª–µ–Ω–Ω–æ—Å—Ç–∏ –º—É–∂—á–∏–Ω—ã (Romeo), $J(t)$ -- —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–ª—é–±–ª–µ–Ω–Ω–æ—Å—Ç–∏ –∂–µ–Ω—â–∏–Ω—ã (Juliet).


a = $(@bind a Slider(-1:.1:1; default=0, show_value=true))

b = $(@bind b Slider(-1:.1:1; default=0, show_value=true))

c = $(@bind c Slider(-1:.1:1; default=0, show_value=true))

d = $(@bind d Slider(-1:.1:1; default=0, show_value=true))
"""

# ‚ïî‚ïê‚ï° 87c0c957-0e5e-4d7f-95dd-f1ea3322565f
begin
	function rj!(du, u, p, t)
		du[1] = p[1]*u[1] + p[2]*u[2]
		du[2] = p[3]*u[1] + p[4]*u[2]
	end

	struct Love
		a::Float64
		b::Float64
		c::Float64
		d::Float64

		solution

		Love(; a::Float64=0, b::Float64=0, c::Float64=0, d::Float64=0, tmax=1000) = 
			new(
				a, b, c, d,
				ODEProblem(
					rj!,
					[1, 1],
					(0, tmax),
					(a, b, c, d)
				) |> solve
			)
	end

	@recipe function f(rj::Love)
		title := "Romeo & Juliet"
		label := :none
		ratio := :equal
		vars := (1, 2)
		rj.solution
	end

	function stream(rj::Love)
		fig = Figure()
		ax = Axis(fig[1, 1])
		streamplot!(
			(R, J) -> Point(
				rj.a * R + rj.b * J,
				rj.c * R + rj.d * J
			), -10..10, -10..10
		)
		fig
	end
end;

# ‚ïî‚ïê‚ï° 7f0f4826-0518-4ab5-82fe-764f4724cc17
rj = Love(a=a, b=b, c=c, d=d);

# ‚ïî‚ïê‚ï° 43c4accb-ff54-4065-bbec-9e2cdfec607e
rj |> plot

# ‚ïî‚ïê‚ï° 6587f853-c836-43ab-8f97-099a85742b2d
rj |> stream

# ‚ïî‚ïê‚ï° Cell order:
# ‚ïü‚îÄ24859bea-a037-11ec-1529-ede51f9bb656
# ‚ïü‚îÄ45d13863-edb9-4eb1-879d-8d4221deca50
# ‚ïü‚îÄb0cfb272-ebe8-444a-b9e2-7ed8d3979003
# ‚ïü‚îÄ22ef3e0d-c2d7-4806-8d80-793f9ce960b2
# ‚ï†‚ïê7abf4e62-af22-4906-9e23-4f18dd7f67ab
# ‚ï†‚ïê03ecedd8-5700-4f61-b3e8-72c042c73c11
# ‚ï†‚ïê5222ff14-5197-4af7-801d-bf652fa8a88a
# ‚ïü‚îÄ167ae2e2-0e79-4bb6-a12d-f11f0a5ff0a9
# ‚ïü‚îÄ3755c8f9-466a-4cad-be08-385503dbcd6b
# ‚ïü‚îÄaed932a2-e563-475d-84a8-2f6d0d35c32e
# ‚ïü‚îÄ6cd36f0b-f2b3-4885-8a4a-16b917e8aa7e
# ‚ïü‚îÄc46c02cd-5d1a-4f8b-aadd-50e223dde894
# ‚ïü‚îÄ8088e6e3-6a90-46d8-9a92-ec143ce55685
# ‚ïü‚îÄ7b39fe50-fc4a-4b65-b339-d3f6c039c172
# ‚ïü‚îÄ86e09784-7678-43ac-885e-6d3eedca7f3e
# ‚ïü‚îÄf0eb22f4-b81b-46f3-8157-e99b4c6b5018
# ‚ï†‚ïê12fc6293-a695-4c9c-8682-8892dfa081cb
# ‚ï†‚ïêc2d02d98-3236-4f44-be6a-78524cc44e6c
# ‚ï†‚ïê971c1060-6519-4ca2-a873-6c5fccca3caa
# ‚ïü‚îÄ54a9c715-1e37-4f02-8b61-1378fa48d54b
# ‚ïü‚îÄ168e14d8-933f-445e-a9e6-905611b6e4d7
# ‚ï†‚ïê529ec0e3-2a4b-422d-949e-ab3a6938ce9c
# ‚ïü‚îÄcea0ab76-7faf-48c3-b6e3-421c76a63082
# ‚ïü‚îÄ118ae518-5e84-4884-af6b-14cd398aca03
# ‚ïü‚îÄdb5f5fae-9ee8-4846-8e8a-0185421d1166
# ‚ïü‚îÄ0bd590eb-9225-4b6b-bbcf-601e0ab074c3
# ‚ï†‚ïêcf150f5e-c6cd-43b6-9409-12ffd2dc565b
# ‚ïü‚îÄ4a208463-d0b5-49ce-9cb6-bc6016eef865
# ‚ïü‚îÄ7f5bad32-53dc-4ed8-b7ef-f9a76a00b85a
# ‚ïü‚îÄ1b736870-409e-4efe-b724-5977352378ae
# ‚ïü‚îÄbe39fcb8-5592-4a7d-8d29-5dc1f28d22a5
# ‚ïü‚îÄb5ac39a0-b3f0-4c94-933c-6f707df8989e
# ‚ïü‚îÄ6c18fcfd-9f3e-4ef7-a273-1592a3ca0230
# ‚ïü‚îÄ7dcf43d8-f9ae-4db1-bb95-e6e12fe305f6
# ‚ïü‚îÄ292baf02-5fcf-4978-a5ef-2973f1520998
# ‚ïü‚îÄ87c0c957-0e5e-4d7f-95dd-f1ea3322565f
# ‚ï†‚ïê7f0f4826-0518-4ab5-82fe-764f4724cc17
# ‚ï†‚ïê43c4accb-ff54-4065-bbec-9e2cdfec607e
# ‚ï†‚ïê6587f853-c836-43ab-8f97-099a85742b2d
